# 7단계: 도구 및 템플릿

## 목표
효율적인 작업을 위한 도구와 템플릿 준비

## 작업 내용

### 1. 테스트 스크립트 작성
```python
# test_prompt.py 템플릿
import openai
import json

def test_classification(system_prompt, test_cases):
    results = []
    for case in test_cases:
        # GPT-4o mini API 호출
        response = openai.ChatCompletion.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": case['input']}
            ]
        )
        
        result = {
            'input': case['input'],
            'expected': case['expected'],
            'actual': response.choices[0].message.content.strip(),
            'correct': response.choices[0].message.content.strip() == str(case['expected'])
        }
        results.append(result)
    
    return results
```

### 2. 평가 지표 계산 도구
```python
# metrics.py 템플릿
def calculate_metrics(results):
    tp = fp = tn = fn = 0
    
    for result in results:
        actual = int(result['actual'])
        expected = result['expected']
        
        if actual == 1 and expected == 1: tp += 1
        elif actual == 1 and expected == 0: fp += 1
        elif actual == 0 and expected == 0: tn += 1
        elif actual == 0 and expected == 1: fn += 1
    
    accuracy = (tp + tn) / len(results)
    precision = tp / (tp + fp) if (tp + fp) > 0 else 0
    recall = tp / (tp + fn) if (tp + fn) > 0 else 0
    f1 = 2 * (precision * recall) / (precision + recall) if (precision + recall) > 0 else 0
    
    return {
        'accuracy': accuracy,
        'precision': precision,
        'recall': recall,
        'f1_score': f1
    }
```

### 3. 프롬프트 템플릿
```
# 기본 구조 템플릿
당신은 뉴스 기사를 분석하여 자동차 관련 여부를 판단하는 전문가입니다.

## 역할
[역할 정의]

## 분류 기준
[명확한 분류 규칙]

## 출력 규칙
- 자동차 관련: 1
- 자동차 무관: 0
- 다른 텍스트 출력 금지

[기사]
제목: {title}
내용: {content}

판단 결과:
```

### 4. 데이터 관리 도구
- [ ] 테스트 케이스 JSON 파일 구조
- [ ] 결과 로깅 시스템
- [ ] 버전 관리 체계
- [ ] 백업 및 복구 방안

## 산출물
- test_prompt.py
- metrics.py
- prompt_templates.txt
- data_manager.py

## 다음 단계
실제 작업 시작 (01_데이터_분석.md부터 순서대로 진행)